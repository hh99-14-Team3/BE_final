
<div align=center>

![header](https://capsule-render.vercel.app/api?type=cylinder&color=00EFFF&text=MOGAKKO%20ON:&fontAlignY=50&fontSize=50&height=150&animation=blink)

</div>

> 항해99 14기 실전 프로젝트 <br>
> BE : 신동현 박다솜 변희준 정종현 / FE : 신주영 신희제 조현정 <br>
> DE : 임현서

<br/>
<div align=center>
  
![브로셔](https://github.com/godjooyoung/final_fe/assets/58963027/2f6133d2-0bc7-452b-9fe6-90b5f2d2bc33)

</div>

## ⌚ 프로젝트 기간
2023-05-19 ~ 2023-06-29 <br>
1차 릴리즈 : 6.17
<br>
<br>
## 👀 프로젝트 소개
<div>
  <table style="border:none">
    <tr>
      <td>
        <img width="500" alt="main" src="https://github.com/hh99-14-Team3/BE_final/assets/102853354/18121c2a-63b0-4e7d-b763-b4a53b73f651"/>
      </td>
      <td>
        모여서 각자 코딩, <b>`모각코`</b>라는 말이 생겨날 정도로 개발자들에게 중요한 문화로 자리 잡은 함께 모여 코딩하기 <br/> 
        코드 리뷰를 조금 더 재밌게, 색다르게, 더 편하고 쉽게 할 수는 없을까? <br/> 도대체 모각코 어디서 구하지? <br/>
        온라인 모각코 서비스 플랫폼 `모각코 ON:`에서 모든 것이 가능하다구 😀 <br/>
        내 근처에 있는 이웃 개발자들과 온라인에서 모여서 각자 코딩하고 <br/>
        정말 맘에 드는 친구가 생겼다면 집 앞 카페에서 슬리퍼 신고 만나 편하게 코딩해보자구!! <br/>
        <br/>
        커뮤니티 문화가 중요한 개발자들의 편안한 코드 모임을 위해<br/>
        개발자의, 개발자에 의해, 개발자를 위해, <br/>
        <b>[모각코 ON:]이 탄생하였습니다.</b>
      </td>
    </tr>
  </table>
</div>

<br>

<h3>🌱 주요 기능 및 서비스 이미지</h3>

<details>
<summary>화상 채팅 + 음성 채팅 + 일반 채팅 + 화면공유가 가능한 <b>모각코 룸</b></summary>
<br/>
<div align=center>
<img src='https://github.com/godjooyoung/final_fe/assets/58963027/ca3eb39b-846b-49e0-9654-96c6f52b0fd1' width='800px'>
</div>
</details>

<details>
<summary>간단한 코드를 작성하고 싶다면? 모각코 룸 내에서 <b>코드에디터</b> 제공</summary>
<br/>
<div align=center>
<img src='https://github.com/godjooyoung/final_fe/assets/58963027/d587bd5c-8a87-4462-a28f-528f308c83dc' width='800px'>
</div>
</details>

<details>
<summary>모각코 룸에서 만났는데 불량유저라면? 신고기능 혹은 헤어지기 아쉽다면, 친구 신청 </summary>
<br/>
<div align=center>
<img src='https://github.com/godjooyoung/final_fe/assets/58963027/e00d340d-727e-4337-8bf0-7c4220ef95a1' width='800px'>
</div>
</details>

<details>
<summary>내 <b>위치를 기반</b>으로 근처에 있는 개발자들과 모임 가능!</summary>
<br/>
<div align=left>
현재 접속 위치 기반 12km내의 생성된 모각코에 참여 가능합니다!
</div>
</details>

<details>
<summary>내가 얼마나 공부했더라? 마이 페이지에서 볼 수 있는 나의 통계 데이터</summary>
<br/>
<div align=center>
<img src='https://github.com/godjooyoung/final_fe/assets/58963027/186ba5e0-9a4e-4a91-831f-09caafe535d2' width='800px'>
</div>
</details>

<details>
<summary>친구와 <b>쪽지</b>를 주고 받으며 함께 모각코 인연을 이어갈 수 있도록 지원</summary>
<br/>
<div align=center>
<img src='https://github.com/godjooyoung/final_fe/assets/58963027/1a9279d5-c294-4ff2-a168-f15b5fa666ba' width='800px'/>
</div>
</details>

<details>
<summary>모각코룸에서 만나지 않았던 유저라도 <b>닉네임이나 친구코드로 친구신청</b>을 할 수 있어요!</summary>
<br/>
<div align=center>
<img src='https://github.com/godjooyoung/final_fe/assets/58963027/c6529fe6-ccc8-4be2-b5bb-639d7c260b72' width='800px'>
</div>
</details>

<details>
<summary>다른 사람은 얼마나 하나? 오늘의 Best 유저 조회 기능</summary>
<br/>
최근 일주일 공부시간과 코딩온도(ON°)로 베스트 유저 8인을 보여줘요! 모각코온 베스트유저에 도전하세요.
<br/>
  <br/>
<div align=center>
<img src='https://github.com/godjooyoung/final_fe/assets/58963027/e0642da8-1578-44a3-8d5f-22a34642c30b' width='800px'>
</div>
</details>

<details>
<summary><b>코딩 온도(ON°)</b> 시스템으로 모각코에 성실히 참여한 사람인지 판단할 수 있도록 지표 제공</summary>
<br/>
<div align=left>
다른 유저의 코딩 온도(ON°)를 확인하여 얼마나 성실히 모각코를 수행한 사람인지 판단할 수 있어요!
</div>

</details>


<br>
<br>

## 🖥️ 기술 아키텍쳐

<div align = center>
<img width="900" alt="architecture" src="https://github.com/hh99-14-Team3/BE_final/assets/102853354/25549d3b-fb63-4438-a980-a34b37900569">
</div>
<br>
<br>

## ⚠️ Trouble Shooting
<h4>BACKEND</h4>
 <ul>
 <li>
 <table width='800px'>
  <tr>
    <th colspan="2" height="50">하나의 인스턴스에 api서버와 openvidu 서버를 동시에 배포 시 두 서버간 연결이 안되고, 포트가 충돌하는 문제 발생</th>
  </tr>
  <tr>
<th width="70">원인</th>
    <td>화면공유 시 보안상의 이유로 https 배포 시도 <br>
        But, openvidu 서버 자체적으로 nginx를 사용하고 있어서 https 포트가 충돌하는 것이 원인이었음</td>
  </tr>
  <tr>
    <th>시도</th>
    <td>openvidu와 api서버를 각각의 다른 인스턴스로 배포 재시도 (Scale-out)</td>
  </tr>
  <tr>
    <th>해결</th>
    <td>openvidu와 api서버가 각각 다른 도메인을 갖게 되어서 포트가 겹쳐도 문제가 발생하지 않았음.</td>
  </tr>
</table>
</li>


 <li>
 <table width='800px'>
  <tr>
    <th colspan="2" height="50">SSE 기능 구현 시 구독 후 connection pool을 계속 차지하여 pending 이 발생하고 DB에 deadLock이 걸리는 문제</th>
  </tr>
  <tr>
<th width="70">원인</th>
    <td>sseEmitter가 구독을 끊어도 계속 connection pool을 차지하고 있어서 발생하는 문제였음</td>
  </tr>
  <tr>
    <th>시도</th>
    <td>1차 Scale-up : 비용문제로 프리티어로 제공되는 RDS를 사용중이었기 때문에 스케일업 진행 <br>
        2차 nginx 설정 변경 : nginx에 이벤트 스트림 설정을 추가하여 sse가 http1.1 버젼을 사용하도록 설정 <br>
        3차 DB 변경 : 다른 NoSQL을 사용하여 DB 분리 진행</td>
  </tr>
  <tr>
    <th>해결</th>
    <td> SSE 관련 요청이 끝나면 영속성 컨텍스트를 닫도록 OSIV 설정을 변경함 <br>
         이후 매번 DB에 직접 commit 해주어야 하는 사이드 이펙트가 발생하였음</td>
  </tr>
</table>
</li>


 <li>
 <table width='800px'>
  <tr>
    <th colspan="2" height="50">
    클라이언트에서 서버로 요청을 보냈을 때 CORS 에러가 비주기적으로 발생하는 문제
    </th>
  </tr>
  <tr>
<th width="70">원인</th>
    <td>nginx와 api 서버에서 CORS 설정을 중복으로 하고 있는 것이 원인</td>
  </tr>
  <tr>
    <th>시도</th>
    <td>1차 : CORS 에러가 처음 등장했을 때 OpenVidu 서버에 연결되는 요청만 발생하여 OpenVidu 서버의 .env 파일에서 CORS 설정을 변경함 <br>
        2차 : nginx와 api 서버 간의 CORS 설정을 최소화함</td>
  </tr>
  <tr>
    <th>해결</th>
    <td>nginx의 CORS 설정을 제거하고 api 서버의 CORS 관련 로직을 재구성하여 해결</td>
  </tr>
</table>
</li>
</ul>
</div>

</details>


## 🔎 기술적 도전
#### BACKEND
1. Github Actions
2. Jacoco
3. Redis Pub/Sub
4. SSE
5. webRTC - OpenVidu

#### FRONTEND
1. webRTC - OpenVidu
2. 실시간 프로토콜 - 웹소캣, SSE
3. 코드 최적화 - redux-thunk
4. 웹사이트 최적화 - Lighthouse
5. 상태 관리 라이브러리 - redux toolkit

## ⛳ 기술적 의사결정
<details>
<summary>BACKEND</summary>
<div markdown="1">
  
- `openVidu`
    - 이용자들이 온라인에서 원할하게 모각코 모임을 가질 수 있도록 하기 위해 도입.
    - 화상 채팅과 화면공유를 구현할때 N:M 으로 스트림을 공유하기 위해서 webRTC 보다 라이브러리 사용이 보다 안정적이고 사용성이 좋을것으로 판단해 도입.
- `redis`
    - TTL 기능을 이용하여 access token, refresh token 등의 휘발성 데이터들을 효율적으로 저장하기 위해 도입.
- `redis pub/sub`
    - 모각코 방 내부에서 이용할 수 있는 기능인 채팅이 저장할 필요가 없는 휘발성 데이터라고 판단, redis를 도입하여 redis Pub/Sub 기능을 사용해서 채팅 구현.
- `Github Actions`
    - Jenkins와 github action + EC2 두 가지 선택지 중 GitHub Action이 GitHub 와의 연동이 편하고 빠른 시간 내에 배포할 수 있는 장점이 있으며 GitHub에서 발생하는 이벤트를 처리할 수 있다는 점을 통해 해당 선택지를 도입.
- `Junit5 / jacoco`
    - 작성한 코드가 의도한 대로 동작하는지 확인할 수 있다는 장점과, 테스트 코드는 예상되는 입력과 출력을 정의하고, 코드 실행 결과를 확인하여 코드의 정확성을 검증하고, jacoco를 통해서 커버리지가 어느정도인지 확인해가며 코드 변경이나 리팩토링 후에도 기능의 동작이 올바른지 확인하기 위해서 도입.
- `Swagger`
    - 프론트앤드 개발자 분들이 모든 엔드포인트를 살펴볼 수 있을 뿐만 아니라 요청을 보내고 응답을 수신하여 작동 중인 엔드포인트를 즉시 테스트할 수 있도록 하기 위해서 도입.
- `Docker`
    - 각각의 개발자들의  로컬환경과 동일한 환경을 구축하여, 환경으로 인해서 생기는 변수를  방지할 수 있도록 하고, openvidu를 배포하기 위해서 Docker 도입. 아직 소수의 컨테이너를 사용하기 때문에 kubernetes 혹은 swarm은 도입하지 않음.

  
</div>
</details>

<details>
<summary>FRONTEND</summary>
<div markdown="1">
  
- `monaco-editor`
    - 개발 공부를 하는 서비스 이기 때문에 코드 에디터의 필요성을 느껴서 도입
    - Monaco Edito,를 사용하게된 이유는 CodeMirror, Ace Editor와 같이 다양한 코드 에디터들이 있지만 우리 프로젝트는 많은 언어와 호환이되고 자동완성 기능도 적용이 되는 Monaco Editor를 선택
- `char.js`
    - 사용자의 마이페이지에서 모각코를 함에 있어서 동기부여를 해줄 수 있는 정보들을 시각화 해서 보여주기 위해 도입
    - 매일매일 기록되는 모각코 참여시간을 차트의 형태로 한눈에 쉽게 볼 수 있도록 하도록 결정.
    - 다양한 차트 라이브러리 중에서 최근까지 계속해서 업데이트 되고, 많은 사용 레퍼런스가 있는 chart.js가 빠른 개발 기간 내에 적용하기 좋을 것이라고 판단하여 도입함.
- `react-toastify`
    - 커스텀 모달을 사용해서 사용자에게 alert 와 confirm 메세지를 안내하나 사용자의 액션이 별도로 필요없는 메세지를 보여줄때는 스낵바 형태의 메세지가 필요하기 때문에 도입.
- `Geolocation Api, KakaoLocal, KakaoMap Api`
    - Geolocation api 를 사용해 사용자의 접속위치를 받아올 수 있기 때문에 도입.
    - 생성된 방 정보들을 지도에 표시해주기 위해 카카오 로컬과 카카오 맵 api 도입.
- `redux-thunk`
    - 사용자가 전역의 상태값을 바꿀때마다 해당 좌표로 접속한 동네명을 받아오는 외부 api 요청 처리가 필요했다. 매번 요청을 하기전에 다른 요청을 하는 것보다 청크로 중간에 외부 api 요청을 하는 단계를 둘 필요성을 느껴 도입.
- `react-query`
    - 쿼리 캐싱 처리 및 클라이언트 단에서 관리해야 할 상태값을 줄이기 위해 도입
    - 데이터 로딩, 에러 처리 등이 용이하여 유지보수가 편하여 도입
- `styled-component`
    - 스타일을 컴포넌트화 하여 프롭스로 값을 내려주어 조건부 스타일을 하기에 용이하여 도입.
- `react-router-dom`
    - React Router dom을 통해 페이지 이동을 구현하였고 outlet을 통해 전체 레이아웃을 쉽게 설정할 수 있어 도입.
- `react-redux-toolkit`
    - 리액트 전역 상태관리 라이브러리로  프롭스 드릴링 현상을 대비하고 전역으로 상태를 관리하기 위해 도입.
    - 리덕스 보다 설정이 간단하고, 리코일을 새로 배우는거보다 팀원 전체가 러닝커브가 짧을것 같아서 도입
- `vercel`
    - git 커밋을 트리거로 자동으로 빌드되고 배포되기 때문에 AWS S3 보다 배포 과정이 빠르고 용이해서 적용하였음.
    - .env등 환경설정파일을 쉽게 등록하고 관리할 수 있다.
 
      
</div>
</details>
<br>

## 👧🏻 유저 피드백 반영 사항
- [x] 쪽지 기능 강화 (삭제 추가)
- [x] 유저 신고 기능
- [x] 친구 추가 강화 (채팅, 유저검색 추가)
- [x] 관리자 기능
- [x] 튜토리얼
- [x] 보안 강화 - 리프레쉬 토큰
- [x] 메인 검색 속도 개선
- [x] 화면 공유 기능 안정성 강화
- [x] 검색 기능 분리 - 지역, 모각코 제목
- [x] 상태코드 이해 어려움 - 툴팁 추가
- [x] 모각코룸 내에서 참여 인원 확인 기능
- [x] 실시간 채팅 편의성 강화 - 욕설 필터링, 공백입력 방지

<br>

##  ↗️ BACKEND TEST CODE

Total of 295 Test Case / Code Coverage 82% 달성 (Unit Test)


<div align=center>
  <table style="border:none">
    <tr>
      <td>
        <img width="250" alt="main" src="https://github.com/hh99-14-Team3/BE_final/assets/123082067/8cec8da4-d160-45a6-95a3-671254359e69"/>
      </td>
      <td>
        <img width="500" alt="main" src="https://github.com/hh99-14-Team3/BE_final/assets/123082067/6194652d-969d-4127-8684-12ada5f7ea6f"/>
      </td>    
    </tr>
  </table>
</div>


## 💻 Tech Stack

**FRONT-END**
<br>
<div align=center> 
<img src="https://img.shields.io/badge/REACT-00D8FF?style=flat-square&logo=REACT&logoColor=white"/>
<img src="https://img.shields.io/badge/AXIOS-5A29E4?style=flat-square&logo=Axios&logoColor=white"/>
<img src="https://img.shields.io/badge/JAVASCRIPT-F7DF1E?style=flat-square&logo=JAVASCRIPT&logoColor=white"/>
<img src="https://img.shields.io/badge/VERCEL-000000?style=flat-square&logo=VERCEL&logoColor=white"/>
<img src="https://img.shields.io/badge/REACT ROUTER-CC3D3D?style=flat-square&logo=REACT ROUTER&logoColor=white"/>
<img src="https://img.shields.io/badge/STYLED-COMPONENTS-DB7093?style=flat-square&logo=STYLED-COMPONENTS&logoColor=white"/>
<img src="https://img.shields.io/badge/yarn-2C8EBB?style=flat-square&logo=yarn&logoColor=white"/>
<img src="https://img.shields.io/badge/WEBRTC-000000?style=flat-square&logo=webrtc&logoColor=white"/>
<img src="https://img.shields.io/badge/OPENVIDU-1DDB16?style=flat&logo=OPENVIDU&logoColor=white"/>
<img src="https://img.shields.io/badge/REACT QUERY-FF4154?style=flat-square&logo=REACT QUERY&logoColor=white"/>
<img src="https://img.shields.io/badge/HTML5-CANVAS-F68D2E?style=flat-square&logo=&logoColor=white"/>
<img src="https://img.shields.io/badge/SockJS-000000?style=flat-square&logo=SockJS&logoColor=white"/>
<img src="https://img.shields.io/badge/STOMP-000000?style=flat-square&logo=STOMP&logoColor=white"/>
<img src="https://img.shields.io/badge/chart.js-FF6384?style=flat-square&logo=chartdotjs&logoColor=white"/>
<img src="https://img.shields.io/badge/Monaco Editor-673AB8?style=flat-square&logo=REACT&logoColor=white"/>
<img src="https://img.shields.io/badge/redux-764ABC?style=flat-square&logo=redux&logoColor=white"/>
<img src="https://img.shields.io/badge/Redux thuck-999999?style=flat-square&logo=redux&logoColor=white"/>
<img src="https://img.shields.io/badge/Redux ToolKit-4D148C?style=flat-square&logo=redux&logoColor=white"/>
<img src="https://img.shields.io/badge/lighthouse-F44B21?style=flat-square&logo=lighthouse&logoColor=white"/>
</div>

<br>

**BACK-END**
<br>
<div align=center> 
<img src="https://img.shields.io/badge/java-007396?style=for-the-badge&logo=java&logoColor=white"> 
<img src="https://img.shields.io/badge/SPRING BOOT-6DB33F?style=for-the-badge&logo=SPRING BOOT&logoColor=white">
<img src="https://img.shields.io/badge/spring security-6DB33F?style=for-the-badge&logo=springsecurity&logoColor=white">
<img src="https://img.shields.io/badge/JWT-000000?style=flat-square&logo=JWT&logoColor=white"/>
<img src="https://img.shields.io/badge/OAUTH2-000000?style=flat-square&logo=OAUTH2&logoColor=white"/>
<img src="https://img.shields.io/badge/mysql-4479A1?style=for-the-badge&logo=mysql&logoColor=white">
<img src="https://img.shields.io/badge/DOCKER-2496ED?style=flat&logo=Docker&logoColor=white"/>
<img src="https://img.shields.io/badge/redis-DC382D?style=for-the-badge&logo=redis&logoColor=white">
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://img.shields.io/badge/github-181717?style=for-the-badge&logo=github&logoColor=white">
<img src="https://img.shields.io/badge/github actions-2088FF?style=for-the-badge&logo=githubactions&logoColor=white">
<img src="https://img.shields.io/badge/amazon aws-232F3E?style=for-the-badge&logo=amazonaws&logoColor=white">
<img src="https://img.shields.io/badge/amazon rds-527FFF?style=for-the-badge&logo=amazonrds&logoColor=white">
<img src="https://img.shields.io/badge/amazon ec2-FF9900?style=for-the-badge&logo=amazonec2&logoColor=white">
<img src="https://img.shields.io/badge/AMAZON ROUTER 53-FFBB00?style=flat-square&logo=AMAZON ROUTER 53&logoColor=white"/>
<img src="https://img.shields.io/badge/amazon s3-569A31?style=for-the-badge&logo=amazons3&logoColor=white">  
<img src="https://img.shields.io/badge/junit5-25A162?style=for-the-badge&logo=junit5&logoColor=white">
<img src="https://img.shields.io/badge/swagger-85EA2D?style=for-the-badge&logo=swagger&logoColor=white">
<img src="https://img.shields.io/badge/NGINX-1DDB16?style=flat&logo=NGINX&logoColor=white"/>
<img src="https://img.shields.io/badge/WEBRTC-000000?style=flat-square&logo=webrtc&logoColor=white"/>
<img src="https://img.shields.io/badge/KURENTO-000000?style=flat&logo=KURENTO&logoColor=white"/>
<img src="https://img.shields.io/badge/OPENVIDU-1DDB16?style=flat&logo=OPENVIDU&logoColor=white"/>
<img src="https://img.shields.io/badge/HTTPS-FF5E00?style=flat-square&logo=HTTPS&logoColor=white"/>
<img src="https://img.shields.io/badge/SockJS-000000?style=flat-square&logo=SockJS&logoColor=white"/>
<img src="https://img.shields.io/badge/STOMP-000000?style=flat-square&logo=STOMP&logoColor=white"/>
<img src="https://img.shields.io/badge/redis PUB/SUB-DC382D?style=for-the-badge&logo=redis&logoColor=white">
<img src="https://img.shields.io/badge/apachecassandra-1287B1?style=for-the-badge&logo=apachecassandra&logoColor=white">
</div>
<br>

<br>


##  🎓 프로젝트 멤버

<div align=center>


|  이름  |    주특기    |        | GitHub                             | 
|:----:|:---------:|:------:|:-----------------------------------|
| 신동현  |  Spring   | BE 리더  | https://github.com/been1118        |
| 신주영  |   React   | FE 리더  | https://github.com/godjooyoung     |
| 신희제  |   React   |        | https://github.com/Shinheeje       |
| 조현정  |   React   |        | https://github.com/chohyunjungai   |
| 박다솜  |  Spring   |  총무🔫  | https://github.com/mansooonuna     |
| 정종현  |  Spring   |        | https://github.com/Shuan75         |
| 변희준  |  Spring   |        | https://github.com/bheejun         |
| 임현서  | Designer  |  디자이너  |


</div>
